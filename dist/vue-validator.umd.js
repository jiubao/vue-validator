!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["vue-validator"]=e()}(this,function(){"use strict";var t={events:["input"],onSuccess:function(){},onError:function(){},resultKey:"validate$pass",errorKey:"vverrors"},e=Array.isArray,n=function(t){return"string"==typeof t},r=function(t){return null!==t&&"object"==typeof t},i=function(t){return"number"==typeof t},s=function(){};function u(t){return null==t||""===t}function o(t,e,n){e="data-vv-"+e;return 2===arguments.length?t.getAttribute(e):t.setAttribute(e,n)}var a=0;var f=/^1[3456789]\d{9}$/,c=/^\d{15}$/,l=/^\d{17}[\dXx]$/,h=/^[0-9]+$/,v=/^-?\d*(\.\d+)?$/,d={required:function(t){return!u(t)},mobile:function(t){return!u(t)&&f.test(t)},regular:function(t,e){return e.test(t)},idcard:function(t){return!u(t)&&(c.test(t)||l.test(t))},number:function(t){return h.test(String(t))},decimal:function(t){return v.test(t)},max:function(t,e){return!u(t)&&Number(t)<=e},min:function(t,e){return!u(t)&&Number(t)>=e},max_length:function(t,e){return u(t)?e>=0:String(t).length<=e},min_length:function(t,e){return u(t)?e<=0:String(t).length>=e}},y=["INPUT","TEXTAREA","SELECT"],p=function(e,n,r,i,u,a){var f=this;this.id=e,this.el=n,o(n,"id",this.id),this.rules=r||[],this.key=i,this.vm=u,this.fails=[],this.pass=!1,this.onError=t.onError||s,this.onSuccess=t.onSuccess||s,this.validate(a),this._validate=function(){return f.validate()},this.bind()};p.prototype.bind=function(){var e=this;this.key?this.unwatch=this.vm.$watch(this.key,this._validate):y.indexOf(this.el.tagName)>=0&&t.events.forEach(function(t){var n,r,i;n=e.el,r=t,i=e._validate,n.addEventListener(r,i,!1)})},p.prototype.validate=function(e){var n,r=this,i=this.getValue();return this.fails=[],u(i)&&!this.rules.some(function(t){return"required"===t.key})?this.pass=!0:this.pass=!this.rules.some(function(t){var e=d[t.key](i,t.value);return e||r.fails.push(t),!e}),this.vm[t.errorKey]=function(){for(var t=arguments,e={},n=0;n<arguments.length;n++)Object.keys(t[n]).forEach(function(r){return e[r]=t[n][r]});return e}(this.vm[t.errorKey],((n={})[this.key]=this.pass?"":this.fails[0].message,n)),!1!==e&&(this.pass?this.onSuccess(this):this.onError(this)),this.vm[t.resultKey]=S.pass(this.vm),this.pass},p.prototype.getValue=function(){return this.key&&this.vm?(t=this.vm,this.key.split(".").reduce(function(t,e,n,r){return t[e]},t)):this.el.value;var t},p.prototype.destroy=function(){var e=this;this.unwatch&&this.unwatch(),this.el&&t.events.forEach(function(t){return n=e.el,r=t,i=e._validate,void n.removeEventListener(r,i,!1);var n,r,i}),this.el=this.vm=this._validate=null};var m=[];function g(t){return t?m.filter(function(e){return e.vm===t}):m}function E(t){return!g(t).some(function(t){return!t.pass})}function b(t){for(var e=m.length-1;e>=0;e--)if(String(m[e].id)===String(t))return m[e];return""}var S={add:function(e,n,r,i,s){m.push(new p(a++,e,n,r,i,s)),i[t.resultKey]=E(i)},all:g,pass:E,find:b,destroy:function t(e){if(i(e))m.splice(e,1)[0].destroy();else if(n(e))t(m.indexOf(b(e)));else if(e instanceof p)t(m.indexOf(e));else for(var r=m.length-1;r>=0;r--)e&&e!==m[r].vm||t(r)},addRule:function(t,e){d[t]=e},rules:d},k={data:function(){var e;return(e={})[t.resultKey]=!1,e[t.errorKey]={},e},beforeDestroy:function(){S.destroy(this)}},x={bind:function(t,e,n){K(t,e,n)},update:function(t,e,n){e.value!==e.oldValue&&(S.destroy(o(t,"id")),K(t,e,n))},unbind:function(t){var e=S.find(o(t,"id"));e&&e.destroy()}};function K(t,i,s){var a=[];r(i.value)?(a=i.value.rules||[],i.value.required&&a.unshift({key:"required"})):n(i.value)&&!u(i.value)&&i.value.split("|").forEach(function(t){var e=t.split(":"),n={key:e[0]};e[1]&&(n.value=e[1]),a.push(n)});var f=o(t,"path")||i.arg&&i.arg.replace(/\$/g,".")||function(t){var n=t.data.directives;if(!t||!e(n))return"";for(var r=n.length-1;r>=0;r--)if("model"===n[r].name)return n[r].expression;return""}(s);S.add(t,a,f,s.context,!!i.modifiers.init)}return{install:function(e,n){var r;n&&(r=(r=n)||{},t.events=r.events||t.events,t.onSuccess=r.onSuccess||t.onSuccess,t.onError=r.onError||t.onError,t.resultKey=r.resultKey||t.resultKey),e.mixin(k),e.directive("validator",x),e.prototype.$$validator=S}}});