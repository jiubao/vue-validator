!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["vue-validator"]=e()}(this,function(){"use strict";var t={events:["input"],onSuccess:function(){},onError:function(){},resultKey:"validate$pass"},e=Array.isArray,n=function(t){return"string"==typeof t},r=function(t){return null!==t&&"object"==typeof t},i=function(t){return"number"==typeof t},u=function(){};function s(t){return null==t||""===t}function o(t,e,n){e="data-vv-"+e;return 2===arguments.length?t.getAttribute(e):t.setAttribute(e,n)}var a=0;var c=/^1[3456789]\d{9}$/,f=/^\d{15}$/,l=/^\d{17}[\dXx]$/,d=/^[0-9]+$/,v={required:function(t){return!s(t)},mobile:function(t){return!s(t)&&c.test(t)},regular:function(t,e){return e.expression.test(val)},idcard:function(t){return!s(t)&&(f.test(t)||l.test(t))},number:function(t){return d.test(String(t))},max:function(t,e){return!s(t)&&Number(t)<=e},min:function(t,e){return!s(t)&&Number(t)>=e},max_length:function(t,e){return s(t)?e>=0:String(t).length<=e},min_length:function(t,e){return s(t)?e<=0:String(t).length>=e}},h=["INPUT","TEXTAREA","SELECT"],p=function(e,n,r,i,s,a){var c=this;this.id=e,this.el=n,o(n,"id",this.id),this.rules=r||[],this.key=i,this.vm=s,this.pass=!1,this.onError=t.onError||u,this.onSuccess=t.onSuccess||u,this.validate(a),this._validate=function(){return c.validate()},this.bind()};p.prototype.bind=function(){var e=this;this.key?this.unwatch=this.vm.$watch(this.key,this._validate):h.indexOf(this.el.tagName)>=0&&t.events.forEach(function(t){var n,r,i;n=e.el,r=t,i=e._validate,n.addEventListener(r,i,!1)})},p.prototype.validate=function(e){var n=this.getValue();return this.pass=!this.rules.some(function(t){return!v[t.key](n,t.value)}),!1!==e&&(this.pass?this.onSuccess(this):this.onError(this)),this.vm[t.resultKey]=b.pass(this.vm),this.pass},p.prototype.getValue=function(){return this.key&&this.vm?(t=this.vm,this.key.split(".").reduce(function(t,e,n,r){return t[e]},t)):this.el.value;var t},p.prototype.destroy=function(){var e=this;this.unwatch&&this.unwatch(),this.el&&t.events.forEach(function(t){return n=e.el,r=t,i=e._validate,void n.removeEventListener(r,i,!1);var n,r,i}),this.el=this.vm=this._validate=null};var y=[];function m(t){return t?y.filter(function(e){return e.vm===t}):y}function g(t){return!m(t).some(function(t){return!t.pass})}function E(t){return y.find(function(e){return String(e.id)===String(t)})}var b={add:function(e,n,r,i,u){y.push(new p(a++,e,n,r,i,u)),i[t.resultKey]=g(i)},all:m,pass:g,find:E,destroy:function t(e){if(i(e))y.splice(e,1)[0].destroy();else if(n(e))t(y.indexOf(E(e)));else if(e instanceof p)t(y.indexOf(e));else for(var r=y.length-1;r>=0;r--)e&&e!==y[r].vm||t(r)}},S={data:function(){var e;return(e={})[t.resultKey]=!1,e},beforeDestroy:function(){b.destroy(this)}},x={bind:function(t,e,n){$(t,e,n)},update:function(t,e,n){e.value!==e.oldValue&&(b.destroy(o(t,"id")),$(t,e,n))},unbind:function(t){var e=b.find(o(t,"id"));e&&e.destroy()}};function $(t,i,u){var a=[];r(i.value)?(a=i.value.rules||[],i.value.required&&a.unshift({key:"required"})):n(i.value)&&!s(i.value)&&i.value.split("|").forEach(function(t){var e=t.split(":"),n={key:e[0]};e[1]&&(n.value=e[1]),a.push(n)});var c=o(t,"path")||i.arg&&i.arg.replace(/\$/g,".")||function(t){if(!t||!e(t.data.directives))return"";var n=t.data.directives.find(function(t){return"model"===t.name});return n?n.expression:""}(u);b.add(t,a,c,u.context,!!i.modifiers.init)}return{install:function(e,n){var r;n&&(r=(r=n)||{},t.events=r.events||t.events,t.onSuccess=r.onSuccess||t.onSuccess,t.onError=r.onError||t.onError,t.resultKey=r.resultKey||t.resultKey),e.mixin(S),e.directive("validator",x),e.prototype.$$validator=b}}});